import socket
import ssl

def start_tls_client(host='localhost', port=65433):
    context = ssl.create_default_context(ssl.Purpose.SERVER_AUTH)
    context.load_verify_locations(cafile='server.crt')

    with socket.create_connection((host, port)) as client_socket:
        with context.wrap_socket(client_socket, server_hostname=host) as tls_conn:
            print(f"TLS connection established with server at {host}:{port}")
            message = "Hello, TLS Server!".encode()
            tls_conn.sendall(message)
            data = tls_conn.recv(1024)
            print(f"Received from TLS server: {data.decode()}")

if __name__ == "__main__":
    start_tls_client()
